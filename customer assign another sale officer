 DECLARE 
        V_CUSTOMER_ID Number;
        V_SALE_ID NUMBER;
        V_ASSIGN NUMBER;
        V_VALUE NUMBER;
BEGIN 
 
    IF apex_application.g_f01.count <> 0 THEN    
        FOR i IN 1..apex_application.g_f01.count LOOP
            V_CUSTOMER_ID := TO_NUMBER(NVL(apex_application.g_f01(i), 0));  
       UPDATE AB_SALE_INFO_DET
           SET    
            STATUS='N'
            WHERE CUSTOMER_ID=V_CUSTOMER_ID;
     SELECT  NVL(COUNT(*),0) INTO V_ASSIGN  FROM   AB_SALE_INFO  SI WHERE EMP_ID=:P165_NEW_ASSIGN_SALE_OFFER AND  SALE_TYPE='CUSTOMER ASSIGN';
     IF V_ASSIGN=0 THEN 
              INSERT INTO AB_SALE_INFO (SALE_TYPE,EMP_ID,STATUS)
                                 VALUES('CUSTOMER ASSIGN',:P165_NEW_ASSIGN_SALE_OFFER,'Y');
            SELECT AB_SALE_INFO_SEQ.CURRVAL INTO V_VALUE FROM dual;
              INSERT INTO AB_SALE_INFO_DET (SALE_ID,CUSTOMER_ID,DET_SALE_TYPE,STATUS)
                          VALUES(V_VALUE,V_CUSTOMER_ID,'CUSTOMER ASSIGN DET','Y');
     ELSE                     
     SELECT SI.SALE_ID INTO V_SALE_ID FROM   AB_SALE_INFO  SI WHERE EMP_ID=:P165_NEW_ASSIGN_SALE_OFFER AND  SALE_TYPE='CUSTOMER ASSIGN';
    INSERT INTO AB_SALE_INFO_DET (SALE_ID,CUSTOMER_ID,DET_SALE_TYPE,STATUS)
                          VALUES(V_SALE_ID,V_CUSTOMER_ID,'CUSTOMER ASSIGN DET','Y');
      END IF;
        END LOOP;
         
    END IF;
    EXCEPTION WHEN OTHERS THEN NULL;
END;
